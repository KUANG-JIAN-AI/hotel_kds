{% extends "base.html" %}

{% block content %}

<div class="flex justify-between items-center mb-6">
    <h1 class="text-3xl font-bold">ğŸ½ï¸ èœå“åˆ—è¡¨</h1>
    <button id="add-btn" class="bg-blue-600 hover:bg-blue-500 text-white px-4 py-2 rounded-lg">
        â• æ·»åŠ èœå“
    </button>
</div>

<div class="overflow-x-auto">
    <table id="dish-table" class="min-w-full bg-slate-800 rounded-lg shadow-lg">
        <thead>
            <tr>
                <th class="text-left text-slate-200">ID</th>
                <th class="text-left text-slate-200">èœå</th>
                <th class="text-left text-slate-200">é‡é‡(g)</th>
                <th class="text-left text-slate-200">çŠ¶æ€</th>
                <th class="text-left text-slate-200">è¡¥å……å»ºè®®</th>
            </tr>
        </thead>
        <tbody>
            <tr class="border-b border-slate-700">
                <td class="text-slate-100">1</td>
                <td class="text-slate-100">ã‚ªãƒ¼ã‚¹ãƒˆãƒ©ãƒªã‚¢ç”£ãƒ­ãƒ–ã‚¹ã‚¿ãƒ¼</td>
                <td class="text-slate-100">100</td>
                <td><span class="status-normal">ååˆ†</span></td>
                <td class="text-slate-100">--</td>
            </tr>
            <tr class="border-b border-slate-700">
                <td class="text-slate-100">2</td>
                <td class="text-slate-100">ãƒ–ãƒ©ãƒƒã‚¯ãƒšãƒƒãƒ‘ãƒ¼ãƒ“ãƒ¼ãƒ•</td>
                <td class="text-slate-100">85</td>
                <td><span class="status-normal">ååˆ†</span></td>
                <td class="text-slate-100">--</td>
            </tr>
            <tr class="border-b border-slate-700">
                <td class="text-slate-100">3</td>
                <td class="text-slate-100">ãƒ•ã‚©ã‚¢ã‚°ãƒ©</td>
                <td class="text-slate-100">45</td>
                <td><span class="status-warning">è£œå……æ¨å¥¨</span></td>
                <td class="text-slate-100">æ³¨æ„ã—ã¦è£œå……</td>
            </tr>
            <tr>
                <td class="text-slate-100">4</td>
                <td class="text-slate-100">ãƒ†ã‚£ãƒ©ãƒŸã‚¹</td>
                <td class="text-slate-100">20</td>
                <td><span class="status-critical">è‡³æ€¥è£œå……</span></td>
                <td class="text-slate-100">ç«‹å³è¡¥å……</td>
            </tr>
        </tbody>
    </table>
</div>
{% endblock %}


{% block model %}
<!-- å¼¹çª— -->
<div id="modal" class="fixed inset-0 hidden items-center justify-center modal-overlay z-50">
    <div class="bg-slate-800 p-6 rounded-lg w-96 shadow-lg">
        <h2 class="text-xl font-bold mb-4">æ·»åŠ æ–°èœå“</h2>
        <form id="add-form" class="space-y-4">
            <div>
                <label class="block text-slate-200 mb-1">èœå</label>
                <input type="text" id="dish-name" class="modal-input" placeholder="è¯·è¾“å…¥èœå" required>
            </div>
            <div>
                <label class="block text-slate-200 mb-1">é‡é‡(g)</label>
                <input type="number" id="dish-weight" class="modal-input" placeholder="è¯·è¾“å…¥é‡é‡" required>
            </div>
            <div>
                <label class="block text-slate-200 mb-1">çŠ¶æ€</label>
                <select id="dish-status" class="modal-select" required>
                    <option value="normal">ååˆ†</option>
                    <option value="warning">è£œå……æ¨å¥¨</option>
                    <option value="critical">è‡³æ€¥è£œå……</option>
                </select>
            </div>
            <div>
                <label class="block text-slate-200 mb-1">è¡¥å……å»ºè®®</label>
                <input type="text" id="dish-advice" class="modal-input" placeholder="è¯·è¾“å…¥è¡¥å……å»ºè®®">
            </div>
            <div class="flex justify-end gap-2">
                <button type="button" id="cancel-btn" class="modal-btn modal-btn-cancel">å–æ¶ˆ</button>
                <button type="submit" class="modal-btn modal-btn-primary">æ·»åŠ </button>
            </div>
        </form>
    </div>
</div>
{% endblock %}

{% block js %}
<script>
    const addBtn = document.getElementById('add-btn');
    const modal = document.getElementById('modal');
    const cancelBtn = document.getElementById('cancel-btn');
    const addForm = document.getElementById('add-form');
    const tableBody = document.querySelector('#dish-table tbody');

    let nextId = tableBody.rows.length + 1;

    addBtn.addEventListener('click', () => {
        modal.classList.remove('hidden');
        modal.classList.add('flex');
    });

    cancelBtn.addEventListener('click', () => {
        modal.classList.add('hidden');
        modal.classList.remove('flex');
    });

    addForm.addEventListener('submit', (e) => {
        e.preventDefault();
        const name = document.getElementById('dish-name').value;
        const weight = document.getElementById('dish-weight').value;
        const status = document.getElementById('dish-status').value;
        const advice = document.getElementById('dish-advice').value;

        let statusClass = '';
        let statusText = '';
        if (status === 'normal') {
            statusClass = 'status-normal';
            statusText = 'ååˆ†';
        } else if (status === 'warning') {
            statusClass = 'status-warning';
            statusText = 'è£œå……æ¨å¥¨';
        } else {
            statusClass = 'status-critical';
            statusText = 'è‡³æ€¥è£œå……';
        }

        const row = document.createElement('tr');
        row.classList.add('border-b', 'border-slate-700');
        row.innerHTML = `
                <td class="text-slate-100">${nextId++}</td>
                <td class="text-slate-100">${name}</td>
                <td class="text-slate-100">${weight}</td>
                <td><span class="${statusClass}">${statusText}</span></td>
                <td class="text-slate-100">${advice}</td>
            `;
        tableBody.appendChild(row);

        modal.classList.add('hidden');
        modal.classList.remove('flex');
        addForm.reset();
    });
</script>
{% endblock %}